# 07 클래스

**예제 7-5 Rectangle, Square 클래스**

```javascript
var Rectangle = function (width, height) {
  this.width = width;
  this.height = height;
};

Rectangle.prototype.getArea = function () {
  return this.width * this.height;
};

var rect = new Rectangle(3, 4);
console.log(rect.getArea()); // 12

var Square = function (width) {
  this.width = width;
};

Square.prototype.getArea = function () {
  return this.width * this.width;
};

var sq = new Square(5);
console.log(sq.getArea()); // 25
```

사용자가 정의한 두 클래스 Rectangle과 Square 사이에서의 상속 관계를 구현한 코드이다. 코드를 자세히 보면 Rectangle과 Square 클래스에 공통 요소 width와 getArea가 있다는 것을 알 수 있다. 만약 Square에서 height 프로퍼티를 사용하면 getArea를 공통으로 사용할 수 있다.

**예제 7-6 Square 클래스 변형**

```javascript
var Square = function (width) {
  this.width = width;
  this.height = width;
};

Square.prototype.getArea = function () {
  return this.width * this.height;
};
```

getArea의 형태도 같으므로 Square를 Rectangle의 하위 클래스로 만들 수 있다. getArea라는 메서드는 동일한 동작을 하므로, 상위 클래스인 Rectangle에서만 정의하고, 하위 클래스에서는 해당 메서드를 상속하면서 height 대신 width를 넣으면 된다.

**예제 7-7 Rectangle을 상속하는 Square 클래스**

```javascript
var Square = function (width) {
  Rectagle.call(this, width, width);
};

Square.prototype = new Rectangle();
```

Square의 생성자 함수 내부에서 Rectangle의 생성자 함수를 함수로써 호출한 코드이다. getArea 메서드를 상속하기 위해 Square의 프로토타입 객체에 Rectangle의 인스턴스를 부여하였다.

> Square를 this로 지정하기 위해 call 메서드를 사용한 것이다. 만약 지정하지 않으면 전역 객체가 this가 된다.

**그림 7-7 예제 7-6의 sq 인스턴스에 대한 콘솔 출력 결과**
<img src="/img/class/7-7.JPG" alt="7-7.JPG" />

**그림 7-8 Rectangle -> Square 상속 관계 구현(1) - 도식**
<img src="/img/class/7-8.jpg" alt="7-8.jpg" />

그림을 보면 Square가 Rectangle의 인스턴스인 것과, 1) width와 height에 undefined가 할당되었다는 것을 알 수 있다. 또한 2) constructor가 Square가 아닌 Rectangle을 바라보고 있다는 것을 알 수 있다. 즉 하위 클래스로 삼을 생성자 함수의 prototype에 상위 클래스의 인스턴스를 부여하는 것만으로도 기본적인 메서드 상속은 가능하지만 다양한 문제가 발생할 수 있는 것이다.

### 7-3-2 클래스가 구체적인 데이터를 지니지 않게 하는 방법

첫 번째 방법은 프로퍼티들을 일일이 지우고, 더는 새로운 프로퍼티를 추가할 수 없게 만드는 것이다.

```javascript
delete Square.prototype.width;
delete Square.prototype.height;
Object.freeze(Square.prototype);
```

**예제 7-8 클래스 상속 및 추상화 방법(1) - 인스턴스 생성 후 프로퍼티 제거**

```javascript
var Rectangle = function (width, height) {
  this.width = width;
  this.height = height;
};

Rectangle.prototype.getArea = function () {
  return this.width * this.height;
};

var extendClass1 = function (SuperClass, SubClass, subMethods) {
  SubClass.prototype = new SuperClass();
  for (var prop in SubClass.prototype) {
    if (SubClass.prototype.hasOwnProperty(prop)) {
      delete SubClass.prototype[prop];
    }
  }
  if (subMethods) {
    for (var method in subMethods) {
      SubClass.prototype[method] = subMethods[method];
    }
  }
  Object.freeze(SubClass.prototype);
  return SubClass;
};

var Square = extendClass1(Rectangle, function (width) {
  Rectangle.call(this, width, width);
});
```

❗ 정확한 출력 값을 확인하기 위해서는 Rectangle 생성 코드와 함께 작성해야 한다.

SuperClass는 Rectangle, SubClass는 Square, subMethods는 getArea이다. 먼저 SubClass의 프로토타입에 SuperClass의 인스턴스를 할당하고, undefined가 할당되었던 프로퍼티들을 일일이 지우고, SubClass의 프로토타입을 할당하는 것이다. 그런 다음에 freeze를 통해 더는 프로퍼티를 바꿀 수 없도록 만들었다.

**예제 7-9 클래스 상속 및 추상화 방법(2) - 빈 함수를 활용**

```javascript
var extendClass2 = (function () {
	var Bridge = fuction () {};    // 빈 생성자 함수인 Bridge 선언
    return function (SuperClass, SubClass, subMethods) {	// 클로저
    	Bridge.prototype = SuperClass.prototype;
        SubClass.prototype = new Bridge();
        if (subMethods) {
        	for (var method in subMethods) {
            	SubClass.prototype[method] = subMethods[method];
            }
        }
        Object.freeze(SubClass.prototype);
        return SubClass;
    };
})();
```

SubClass의 프로토타입에 직접 SuperClass의 인스턴스를 할당하는 것이 아니라 아무런 프로퍼티를 생성하지 않는 빈 생성자 함수(Bridge)를 하나 더 만들어서 그 프로토타입이 SuperClass의 프로토타입을 바라보게 한 다음에 SubClass의 프로토타입에는 Bridge의 인스턴스를 할당하게 하는 것이다.

즉시 실행 함수 내부에서 Bridge를 선언하고, 이를 클로저로 활용한 것이다.

> 클로저 : 어떤 함수 A(extendClass2) 에서 선언한 변수 a(Bridge) 를 참조하는 내부함수 B(return 이후) 를 외부로 전달할 경우 A의 실행 컨텍스트가 종료된 이후에도 변수 a(Bridge) 가 사라지지 않는 현상
>
> 클로저때문에 return 이후에도 Bridge를 사용할 수 있는 것이다.

**그림 7-9 클래스 상속 및 추상화 방법(2) - 빈 함수를 활용**
<img src="/img/class/7-9.jpg" alt="7-9.jpg" />

**예제 7-10 클래스 상속 및 추상화 방법(3) - Object.create 활용**

```javascript
Square.prototype = Object.create(Rectangle.prototype);
Object.freeze(Square.prototype);
```

> Object.create() : 지정된 프로토타입 객체 및 속성 (property)을 갖는 새 객체 생성
