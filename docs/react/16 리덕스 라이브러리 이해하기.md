# 16 리덕스 라이브러리 이해하기

리덕스는 가장 많이 사용하는 리액트 상태 관리 라이브러리이다. 리덕스를 사용하면 컴포넌트의 상태 업데이트 관련 로직을 다른 파일로 분리시켜서 더욱 효율적으로 관리할 수 있다. 또한, 컴포넌트끼리 똑같은 상태를 공유해야 할 때도 여러 컴포넌트를 거치지 않고, 손쉽게 상태 값을 전달하거나 업데이트 할 수 있다.

## 16.1 개념 미리 정리하기

### 16.1.1 액션

상태에 어떠한 변화가 필요하면 액션이 발생한다. 액션은 하나의 객체로 표현되는데, 다음과 같은 형식으로 이루어져 있다.

```javascript
{
    type: 'ADD_TODO',
    data: {
        id: 1,
        text: '리덕스 배우기'
    }
}
```

### 16.1.2 액션 생성 함수

액션 생성 함수는 변화를 일으켜야 할 때 액션 객체를 효율적으로 생성하기 위한 함수이다.

```javascript
function addTodo(data) {
  return {
    type: "ADD_TODO",
    data,
  };
}

const changeInput = (text) => ({
  type: "CHANGE_INPUT",
  text,
});
```

### 16.1.3 리듀서

리듀서는 변화를 일으키는 함수이다. 리듀서가 현재 상태와 전달받은 액션 객체를 파라미터로 받아오면 두 값을 참고하여 새로운 상태를 만들어서 반환한다.

```javascript
const initialState = {
  counter: 1,
};

function reducer(state = initialState, action) {
  switch (action.type) {
    case INCREMENT:
      return {
        counter: state.counter + 1,
      };
    default:
      return state;
  }
}
```

### 16.1.4 스토어

리덕스를 적용하기 위해 스토어를 만든다. 한 개의 프로젝트에는 단 하나의 스토어만 가질 수 있다. 스토어 안에는 현재 애플리케이션 상태와 리듀서가 들어가 있으며, 몇 가지 내장 함수를 지니고 있다.

### 16.1.5 디스패치

디스패치는 스토어의 내장 함수 중 하나이다. 액션을 발생시키는 것으로, 액션 객체를 파라미터로 넣어서 호출한다. 이 함수가 호출되면 스토어는 리듀서 함수를 실행시켜서 새로운 상태를 만들어 반환한다.

### 16.1.6 구독

구독도 스토어의 내장 함수 중 하나이다. subscribe 함수 안에 리스터 함수를 파라미터로 넣어서 호출하면, 이 리스너 함수가 액션이 디스패치되어 상태가 업데이트될 때마다 호출된다.

```javascript
const listener = () => {
  console.log("상태가 업데이트됨");
};

const unsubscribe = store.subscribe(listener);

unsubscribe();
```



## 16.3 리덕스의 세 가지 규칙

### 16.3.1 단일 스토어

하나의 애플리케이션에는 하나의 스토어를 사용합니다. 여러 개의 스토어를 만들 수도 있지만, 상태 관리가 복잡해질 수 있으므로 권장하지 않습니다.

### 16.3.2 읽기 전용 상태

리덕스 상태는 읽기 전용입니다. 기존 리액트에서 setState를 사용하여 state를 업데이트할 때도 객체나 배열을 업데이트하는 과정에서 불변성을 지켜 주기 위해 spread 연산자를 사용하거나 immer와 같은 불변성 관리 라이브러리를 사용한 것처럼 리덕스도 마찬가지입니다. 

불변성을 유지하는 이유는 내부적으로 데이터가 변경되는 것을 감지하기 위해 얕은 비교 검사를 하기 때문입니다. (성능 유지)

### 16.3.3 리듀서는 순수 함수

변화를 일으키는 리듀서 함수는 순수한 함수여야 합니다. 

**순수한 함수**

- 리듀서 함수는 이전 상태와 액션 객체를 파라미터로 받습니다.

- 파라미터 외의 값에는 의존하면 안 됩니다. 

- 이전 상태는 절대 건드리지 않고, 변화를 준 새로운 상태 객체를 만들어서 반환합니다.

- 똑같은 파라미터로 호출된 리듀서 함수는 언제나 똑같은 결과 값을 반환해야 합니다.

  
